<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Buffet Manager - Sistema Pro</title>
    <style>
        :root { --dark: #121212; --gray: #1e1e1e; --accent: #00e676; --text: #e0e0e0; }
        body { font-family: 'Inter', sans-serif; margin: 0; display: flex; background: var(--dark); color: var(--text); }
        
        /* Menu Lateral */
        nav { width: 280px; background: var(--gray); height: 100vh; position: fixed; padding: 20px; border-right: 1px solid #333; }
        nav h2 { color: var(--accent); font-size: 1.2rem; margin-bottom: 30px; letter-spacing: 1px; }
        .menu-item { width: 100%; padding: 12px; margin-bottom: 10px; background: #252525; border: none; color: white; text-align: left; border-radius: 6px; cursor: pointer; transition: 0.2s; }
        .menu-item:hover { background: #333; border-left: 4px solid var(--accent); }
        .sub-label { font-size: 0.75rem; color: #888; margin-left: 5px; text-transform: uppercase; }

        /* √Årea Principal */
        main { margin-left: 320px; padding: 40px; width: 100%; }
        .card { background: var(--gray); padding: 25px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        /* Navega√ß√£o tipo "Breadcrumb" */
        .breadcrumb { margin-bottom: 20px; font-size: 0.9rem; color: var(--accent); cursor: pointer; }

        /* Tabelas e Itens */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { text-align: left; padding: 15px; border-bottom: 2px solid #333; color: #888; }
        td { padding: 15px; border-bottom: 1px solid #333; }
        
        .clickable-row { cursor: pointer; transition: 0.2s; }
        .clickable-row:hover { background: #252525; }

        .btn-qty { background: #333; border: 1px solid #444; color: white; padding: 5px 12px; border-radius: 4px; cursor: pointer; }
        .btn-qty:hover { background: var(--accent); color: black; }
        
        .badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; background: #333; }
        .low { color: #ff5252; border: 1px solid #ff5252; }
    </style>
</head>
<body>

<nav>
    <h2>BUFFET CONTROL</h2>
    <p class="sub-label">Almacenamiento</p>
    <button class="menu-item" onclick="viewCategory('C√¢mara')">üßä √çtems de C√°mara</button>
    <button class="menu-item" onclick="viewCategory('Freezer')">‚ùÑÔ∏è √çtems de Freezer</button>
    
    <p class="sub-label">Operaci√≥n</p>
    <button class="menu-item" onclick="viewCategory('Equipo')">‚ö° Equipamientos</button>
    <button class="menu-item" onclick="viewCategory('Material')">üçΩÔ∏è Materiales / Vajilla</button>

    <p class="sub-label">Ventas</p>
    <button class="menu-item" style="background: var(--accent); color: black;" onclick="alert('√Årea del Cliente Conectada')">üç¥ Modo Cliente</button>
</nav>

<main>
    <div id="content-area">
        <div id="breadcrumb" class="breadcrumb" onclick="renderView()">üè† Inicio</div>
        <div class="card">
            <h1 id="view-title">Seleccione una categor√≠a</h1>
            <div id="view-body">Elija una opci√≥n del men√∫ para comenzar.</div>
        </div>
    </div>
</main>

<script>
    // BASE DE DATOS CENTRALIZADA
    let stock = JSON.parse(localStorage.getItem('buffet_pro_db')) || [
        { id: 1, cat: "C√¢mara", local: "C√°mara 1", estante: "Estante A", nombre: "Carne Vacuna", qtd: 20, min: 5, info: "220V / Temp -2C" },
        { id: 2, cat: "C√¢mara", local: "C√°mara 1", estante: "Estante B", nombre: "Pollo Entero", qtd: 15, min: 10, info: "" },
        { id: 3, cat: "Freezer", local: "Freezer Principal", estante: "Gaveta 1", nombre: "Helado Artesanal", qtd: 10, min: 2, info: "" },
        { id: 4, cat: "Equipo", local: "Cocina", estante: "Mesada", nombre: "Horno Convector", qtd: 2, min: 0, info: "Serial: 99283 / 220V" },
        { id: 5, cat: "Material", local: "Dep√≥sito", estante: "Caja 10", nombre: "Platos Porcelana", qtd: 100, min: 80, info: "Modelo Blanco" }
    ];

    let currentCat = "";
    let currentEstante = "";

    function viewCategory(cat) {
        currentCat = cat;
        currentEstante = ""; // Reseta o filtro de estante
        renderView();
    }

    function renderView() {
        const title = document.getElementById('view-title');
        const body = document.getElementById('view-body');
        const bread = document.getElementById('breadcrumb');

        if (!currentCat) return;

        // SE EST√Å NA VIS√ÉO DE CATEGORIA (Mostra as Estantes/Gavetas primeiro)
        if (!currentEstante) {
            bread.innerHTML = `üè† Inicio > ${currentCat}`;
            title.innerText = `Listado de ${currentCat}s`;
            
            // Agrupa por estante para criar os "links"
            const estantes = [...new Set(stock.filter(i => i.cat === currentCat).map(i => i.estante))];
            
            let html = `<table><thead><tr><th>Ubicaci√≥n / Estante</th><th>Acci√≥n</th></tr></thead><tbody>`;
            estantes.forEach(e => {
                html += `<tr class="clickable-row" onclick="viewEstante('${e}')">
                            <td>üìÇ <b>${e}</b></td>
                            <td><small>Ver productos ‚Üí</small></td>
                         </tr>`;
            });
            body.innerHTML = html + "</tbody></table>";
        } 
        // SE EST√Å DENTRO DE UM ESTANTE (Mostra os produtos)
        else {
            bread.innerHTML = `<span onclick="currentEstante='';renderView()">üè† Inicio > ${currentCat}</span> > ${currentEstante}`;
            title.innerText = `Productos en ${currentEstante}`;
            
            const productos = stock.filter(i => i.cat === currentCat && i.estante === currentEstante);
            
            let html = `<table><thead><tr><th>Producto</th><th>Stock</th><th>Info T√©cnica</th><th>Control</th></tr></thead><tbody>`;
            productos.forEach(p => {
                html += `<tr>
                            <td>${p.nombre}</td>
                            <td><span class="badge ${p.qtd <= p.min ? 'low' : ''}">${p.qtd}</span></td>
                            <td><small>${p.info || '-'}</small></td>
                            <td>
                                <button class="btn-qty" onclick="updateStock(${p.id}, 1)">+</button>
                                <button class="btn-qty" onclick="updateStock(${p.id}, -1)">-</button>
                            </td>
                         </tr>`;
            });
            body.innerHTML = html + "</tbody></table>";
        }
    }

    function viewEstante(e) {
        currentEstante = e;
        renderView();
    }

    function updateStock(id, val) {
        const item = stock.find(i => i.id === id);
        item.qtd = Math.max(0, item.qtd + val);
        localStorage.setItem('buffet_pro_db', JSON.stringify(stock));
        renderView();
    }
</script>

</body>
</html>
